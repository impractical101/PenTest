
from __future__ import print_function
import sys
import dns.query
import dns.zone

# Test this script against name_server = 'nsztm1.digi.ninja', domain = 'zonetransfer.me'

def help_text():
        print("\nUsage:python zone_transfer.py name_server domain")
        sys.exit()

def zone_transfer(name_server, domain):
    z = dns.zone.from_xfr(dns.query.xfr(name_server, domain))
    names = z.nodes.keys()
    names.sort()
    return z, names

if __name__ == '__main__':
    if len(sys.argv) < 3:
        help_text()
    name_server = sys.argv[1]
    domain = sys.argv[2]
    z, names = zone_transfer(name_server, domain)
    for n in names:
        print(z[n].to_text(n))
Â© 2019 GitHub, Inc.